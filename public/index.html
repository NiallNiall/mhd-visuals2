<!DOCTYPE html>
<html>

<head>
    <title>Music Hackday Visuals</title>
    <link rel="stylesheet" href="style.css" />
    <script src="/socket.io/socket.io.js"></script>
    <style>
        body {
            background-color: #000;
        }
        </style>
</head>

<body>
    <div id="mainbox" class="fullwidth"></div>
    <script>
    var clrFade = 255;

    var bgBox = document.getElementById("mainbox");

    function setBoxClr(thisBox, thisClr) {
        thisBox.style.background = 'rgba(' + thisClr + ', ' + thisClr + ', ' + thisClr + ',1.0)';
    }

    // The problem was I just needed to use io.emit!
    document.addEventListener("DOMContentLoaded", function() {

        var socket = io.connect();

        // This is listening for message called myFunc
        socket.on('myFunc', function(data) {
            console.log(data.ting);
        });

        // This is listening for message called myFunc
        socket.on('beat', function(data) {
            console.log(data.ting);
            clrFade = 255;
        });

        socket.on('liveBeat', function(data) {
            // var thisFade = 255 - data.clr;
            var thisFade = data.clr;
            // console.log(data.clr);
            // console.log(thisFade);
            setBoxClr(bgBox, thisFade);
        });


        // setBoxClr(bgBox, clrFade);


        // setInterval(function() {
        //     if (clrFade > 1) {
        //         clrFade -= 5;
        //     } else {
        //         clrFade = 0;
        //     }
        //     // console.log(clrFade);

        //     setBoxClr(bgBox, clrFade);
        // }, 10);


    });
    </script>
</body>

</html>